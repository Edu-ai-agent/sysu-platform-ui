import{b as R,g as f,r as j,__tla as E}from"./index.5cfbf42e.js";import{d as M,__tla as O}from"./dept.84d8fcce.js";import{p as W,a as Z,g as z,v as A,b as G,__tla as H}from"./role.ca07fafb.js";import{M as y,r as m,a3 as v,ak as u,au as J,o as D,U as V,V as t,b as K,$ as s,Z as x,_ as $,u as r,W as L,E as Q,n as X}from"./vue.86fe07f1.js";let C,Y=Promise.all([(()=>{try{return E}catch{}})(),(()=>{try{return O}catch{}})(),(()=>{try{return H}catch{}})()]).then(async()=>{let g,b;g={class:"dialog-footer"},b=y({name:"systemRoleDialog"}),C=y({...b,emits:["refresh"],setup(ee,{expose:I,emit:k}){const{t:S}=R(),n=m();m();const c=m(!1),i=m(!1),a=v({roleId:"",roleName:"",roleCode:"",roleDesc:"",dsScope:""}),p=v({deptData:[],checkedDsScope:[],deptProps:{children:"children",label:"name",value:"id"}}),w=m({roleName:[{required:!0,message:"\u89D2\u8272\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:3,max:20,message:"\u957F\u5EA6\u5728 3 \u5230 20 \u4E2A\u5B57\u7B26",trigger:"blur"},{validator:(e,l,d)=>{A(e,l,d,a.roleId!=="")},trigger:"blur"}],roleCode:[{required:!0,message:"\u89D2\u8272\u6807\u8BC6\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:3,max:20,message:"\u957F\u5EA6\u5728 3 \u5230 20 \u4E2A\u5B57\u7B26",trigger:"blur"},{validator:j.validatorCapital,trigger:"blur"},{validator:(e,l,d)=>{G(e,l,d,a.roleId!=="")},trigger:"blur"}],roleDesc:[{max:128,message:"\u957F\u5EA6\u5728 128 \u4E2A\u5B57\u7B26\u5185",trigger:"blur"}]}),N=e=>{c.value=!0,a.roleId="",X(()=>{n.value.resetFields()}),e&&(a.roleId=e,B(e)),T()},U=async()=>{if(!await n.value.validate().catch(()=>{}))return!1;try{i.value=!0,a.roleId?await W(a):await Z(a),f().success(S(a.roleId?"common.editSuccessText":"common.addSuccessText")),c.value=!1,k("refresh")}catch(e){f().error(e.msg)}finally{i.value=!1}},B=e=>{z(e).then(l=>{Object.assign(a,l.data),l.data.dsScope?p.checkedDsScope=l.data.dsScope.split(","):p.checkedDsScope=[]})},T=()=>{M().then(e=>{p.deptData=e.data})};return I({openDialog:N}),(e,l)=>{const d=u("el-input"),_=u("el-form-item"),q=u("el-form"),h=u("el-button"),F=u("el-dialog"),P=J("loading");return D(),V(F,{"close-on-click-modal":!1,title:r(a).roleId?e.$t("common.editBtn"):e.$t("common.addBtn"),width:"600",draggable:"",modelValue:r(c),"onUpdate:modelValue":l[4]||(l[4]=o=>Q(c)?c.value=o:null)},{footer:t(()=>[K("span",g,[s(h,{onClick:l[3]||(l[3]=o=>c.value=!1)},{default:t(()=>[x($(e.$t("common.cancelButtonText")),1)]),_:1}),s(h,{onClick:U,type:"primary",disabled:r(i)},{default:t(()=>[x($(e.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:t(()=>[L((D(),V(q,{model:r(a),rules:r(w),"label-width":"90px",ref_key:"dataFormRef",ref:n},{default:t(()=>[s(_,{label:e.$t("sysrole.roleName"),prop:"roleName"},{default:t(()=>[s(d,{placeholder:e.$t("sysrole.please_enter_a_role_name"),clearable:"",modelValue:r(a).roleName,"onUpdate:modelValue":l[0]||(l[0]=o=>r(a).roleName=o)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),s(_,{label:e.$t("sysrole.roleCode"),prop:"roleCode"},{default:t(()=>[s(d,{placeholder:e.$t("sysrole.please_enter_the_role_Code"),disabled:r(a).roleId!=="",clearable:"",modelValue:r(a).roleCode,"onUpdate:modelValue":l[1]||(l[1]=o=>r(a).roleCode=o)},null,8,["placeholder","disabled","modelValue"])]),_:1},8,["label"]),s(_,{label:e.$t("sysrole.roleDesc"),prop:"roleDesc"},{default:t(()=>[s(d,{placeholder:e.$t("sysrole.please_enter_the_role_description"),maxlength:"150",rows:"3",type:"textarea",modelValue:r(a).roleDesc,"onUpdate:modelValue":l[2]||(l[2]=o=>r(a).roleDesc=o)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[P,r(i)]])]),_:1},8,["title","modelValue"])}}})});export{Y as __tla,C as default};
