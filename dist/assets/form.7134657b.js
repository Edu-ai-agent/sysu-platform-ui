import{b as J,g as q,__tla as K}from"./index.5cfbf42e.js";import{p as L,a as Q,g as X,__tla as Y}from"./datasource.4f323617.js";import{u as ee,__tla as ae}from"./dict.b80056c9.js";import{M as N,r as y,a3 as le,ak as u,au as oe,o as n,U as m,V as r,b as re,$ as s,Z as V,_ as v,u as e,W as se,a as x,ac as $,F as D,Y as _,E as te,n as de}from"./vue.86fe07f1.js";import{__tla as ue}from"./dict.5633e5fc.js";let B,ne=Promise.all([(()=>{try{return K}catch{}})(),(()=>{try{return Y}catch{}})(),(()=>{try{return ae}catch{}})(),(()=>{try{return ue}catch{}})()]).then(async()=>{let w,k;w={class:"dialog-footer"},k=N({name:"systemDatasourceConfDialog"}),B=N({...k,emits:["refresh"],setup(pe,{expose:C,emit:F}){const{t}=J(),h=y(),f=y(!1),b=y(!1),{ds_config_type:j,ds_type:E}=ee("ds_config_type","ds_type"),a=le({id:"",name:"",url:"",username:"",password:void 0,createTime:"",updateTime:"",dsType:"",confType:0,dsName:"",instance:"",port:0,host:""}),R=y({name:[{required:!0,message:"\u522B\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:(d,l,g)=>{var T=/(?=.*[a-z])(?=.*_)/;l&&!T.test(l)?g(new Error("\u6570\u636E\u6E90\u540D\u79F0\u4E0D\u5408\u6CD5, \u7EC4\u540D_\u6570\u636E\u6E90\u540D\u5F62\u5F0F")):g()},trigger:"blur"}],url:[{required:!0,message:"jdbcurl\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],username:[{required:!0,message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],password:[{required:!0,message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],dsType:[{required:!0,message:"\u6570\u636E\u5E93\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],confType:[{required:!0,message:"\u914D\u7F6E\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],dsName:[{required:!0,message:"\u6570\u636E\u5E93\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],instance:[{required:!0,message:"\u5B9E\u4F8B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],port:[{required:!0,message:"\u7AEF\u53E3\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],host:[{required:!0,message:"\u4E3B\u673A\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),S=async d=>{f.value=!0,a.id="",de(()=>{var l;(l=h.value)==null||l.resetFields()}),d&&(a.id=d,await M(d),a.password="********")},z=async()=>{var d;if(!await h.value.validate().catch(()=>{}))return!1;a.password=(d=a.password)!=null&&d.includes("******")?void 0:a.password;try{b.value=!0,a.id?await L(a):await Q(a),q().success(t(a.id?"common.editSuccessText":"common.addSuccessText")),f.value=!1,F("refresh")}catch(l){q().error(l.msg)}finally{b.value=!1}},M=d=>X(d).then(l=>{Object.assign(a,l.data)});return C({openDialog:S}),(d,l)=>{const g=u("el-option"),T=u("el-select"),p=u("el-form-item"),c=u("el-col"),i=u("el-input"),O=u("el-radio"),P=u("el-radio-group"),W=u("el-input-number"),Z=u("el-row"),A=u("el-form"),U=u("el-button"),G=u("el-dialog"),H=oe("loading");return n(),m(G,{title:e(a).id?d.$t("common.editBtn"):d.$t("common.addBtn"),modelValue:e(f),"onUpdate:modelValue":l[11]||(l[11]=o=>te(f)?f.value=o:null),"close-on-click-modal":!1,draggable:""},{footer:r(()=>[re("span",w,[s(U,{onClick:l[10]||(l[10]=o=>f.value=!1)},{default:r(()=>[V(v(d.$t("common.cancelButtonText")),1)]),_:1}),s(U,{type:"primary",onClick:z,disabled:e(b)},{default:r(()=>[V(v(d.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:r(()=>[se((n(),m(A,{ref_key:"dataFormRef",ref:h,model:e(a),rules:e(R),formDialogRef:"","label-width":"90px"},{default:r(()=>[s(Z,{gutter:20},{default:r(()=>[s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.dsType"),prop:"dsType"},{default:r(()=>[s(T,{modelValue:e(a).dsType,"onUpdate:modelValue":l[0]||(l[0]=o=>e(a).dsType=o),placeholder:e(t)("datasourceconf.inputdsTypeTip")},{default:r(()=>[(n(!0),x(D,null,$(e(E),o=>(n(),m(g,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.name"),prop:"name"},{default:r(()=>[s(i,{modelValue:e(a).name,"onUpdate:modelValue":l[1]||(l[1]=o=>e(a).name=o),placeholder:e(t)("datasourceconf.inputnameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.username"),prop:"username"},{default:r(()=>[s(i,{modelValue:e(a).username,"onUpdate:modelValue":l[2]||(l[2]=o=>e(a).username=o),placeholder:e(t)("datasourceconf.inputusernameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.password"),prop:"password"},{default:r(()=>[s(i,{modelValue:e(a).password,"onUpdate:modelValue":l[3]||(l[3]=o=>e(a).password=o),placeholder:e(t)("datasourceconf.inputpasswordTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.confType"),prop:"confType"},{default:r(()=>[s(P,{modelValue:e(a).confType,"onUpdate:modelValue":l[4]||(l[4]=o=>e(a).confType=o)},{default:r(()=>[(n(!0),x(D,null,$(e(j),(o,I)=>(n(),m(O,{label:Number(o.value),border:"",key:I},{default:r(()=>[V(v(o.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(a).confType===0&&e(a).dsType==="mssql"?(n(),m(c,{key:0,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.instance"),prop:"instance"},{default:r(()=>[s(i,{modelValue:e(a).instance,"onUpdate:modelValue":l[5]||(l[5]=o=>e(a).instance=o),placeholder:e(t)("datasourceconf.inputinstanceTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):_("",!0),e(a).confType===0?(n(),m(c,{key:1,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.port"),prop:"port"},{default:r(()=>[s(W,{modelValue:e(a).port,"onUpdate:modelValue":l[6]||(l[6]=o=>e(a).port=o),placeholder:e(t)("datasourceconf.inputportTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):_("",!0),e(a).confType===0?(n(),m(c,{key:2,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.host"),prop:"host"},{default:r(()=>[s(i,{modelValue:e(a).host,"onUpdate:modelValue":l[7]||(l[7]=o=>e(a).host=o),placeholder:e(t)("datasourceconf.inputhostTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):_("",!0),e(a).confType===0?(n(),m(c,{key:3,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.dsName"),prop:"dsName"},{default:r(()=>[s(i,{modelValue:e(a).dsName,"onUpdate:modelValue":l[8]||(l[8]=o=>e(a).dsName=o),placeholder:e(t)("datasourceconf.inputdsNameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):_("",!0),e(a).confType===1?(n(),m(c,{key:4,span:24,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.url"),prop:"url"},{default:r(()=>[s(i,{modelValue:e(a).url,"onUpdate:modelValue":l[9]||(l[9]=o=>e(a).url=o),type:"textarea",placeholder:e(t)("datasourceconf.inputurlTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):_("",!0)]),_:1})]),_:1},8,["model","rules"])),[[H,e(b)]])]),_:1},8,["title","modelValue"])}}})});export{ne as __tla,B as default};
